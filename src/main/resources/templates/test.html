<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API í…ŒìŠ¤íŠ¸ í˜ì´ì§€</title>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header .nav-btn {
            display: inline-block;
            padding: 10px 25px;
            background: white;
            color: #667eea;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .header .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255,255,255,0.3);
        }

        .auth-bar {
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .auth-status {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .status-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .status-badge.logged-in {
            background: #10b981;
            color: white;
        }

        .status-badge.logged-out {
            background: #ef4444;
            color: white;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(550px, 1fr));
            gap: 20px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .card-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
            font-size: 0.9rem;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button.secondary {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        button.danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        button.clear-btn {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
            padding: 8px 16px;
            font-size: 0.85rem;
        }

        .response-box {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }

        .response-box pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .info-text {
            background: #e0e7ff;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #4338ca;
        }

        @media (max-width: 1200px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§ª API í…ŒìŠ¤íŠ¸ í˜ì´ì§€</h1>
            <p style="margin: 10px 0;">ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
            <a href="/" class="nav-btn">â† ë©”ì¸ ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</a>
        </div>

        <div class="auth-bar">
            <div class="auth-status">
                <span class="status-badge logged-out" id="authStatus">ë¡œê·¸ì•„ì›ƒ</span>
                <span id="userInfo"></span>
            </div>
            <button class="danger" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
        </div>

        <div class="grid">
            <!-- ì¸ì¦ ì¹´ë“œ -->
            <div class="card">
                <h2 class="card-title">ğŸ” ì¸ì¦ (Authentication)</h2>

                <div class="info-text">
                    íšŒì›ê°€ì… â†’ ë¡œê·¸ì¸ â†’ í† í° ì €ì¥ ìˆœì„œë¡œ ì§„í–‰í•˜ì„¸ìš”
                </div>

                <div class="form-group">
                    <label>ì´ë©”ì¼</label>
                    <input type="email" id="authEmail" placeholder="user@example.com" value="test@example.com">
                </div>
                <div class="form-group">
                    <label>ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="authPassword" placeholder="ìµœì†Œ 8ì" value="password123">
                </div>
                <div class="form-group">
                    <label>ì´ë¦„</label>
                    <input type="text" id="authName" placeholder="í™ê¸¸ë™" value="í…ŒìŠ¤íŠ¸ìœ ì €">
                </div>
                <div class="form-group">
                    <label>ì „í™”ë²ˆí˜¸</label>
                    <input type="text" id="authPhone" placeholder="010-1234-5678" value="010-1234-5678">
                </div>
                <div class="form-group">
                    <label>ì‚¬ìš©ì ID (ì¡°íšŒìš©)</label>
                    <input type="number" id="userId" placeholder="1" value="1">
                </div>

                <div class="button-group">
                    <button onclick="signUp()">íšŒì›ê°€ì…</button>
                    <button onclick="login()">ë¡œê·¸ì¸</button>
                    <button class="secondary" onclick="getUserById()">ì‚¬ìš©ì ì¡°íšŒ</button>
                    <button class="clear-btn" onclick="clearResponse('authResponse')">Clear</button>
                </div>

                <div class="response-box" id="authResponse">
                    <pre>ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</pre>
                </div>
            </div>

            <!-- ì‚¬ìš©ëŸ‰ ë°ì´í„° ì¹´ë“œ -->
            <div class="card">
                <h2 class="card-title">ğŸ“Š ì‚¬ìš©ëŸ‰ ë°ì´í„° (Usage Data)</h2>

                <div class="form-group">
                    <label>ì‚¬ìš©ëŸ‰ ìœ í˜•</label>
                    <select id="usageType">
                        <option value="ELECTRICITY">ì „ê¸° (ELECTRICITY)</option>
                        <option value="WATER">ìˆ˜ë„ (WATER)</option>
                        <option value="GAS">ê°€ìŠ¤ (GAS)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ì‚¬ìš©ëŸ‰</label>
                    <input type="number" id="usageAmount" placeholder="123.45" value="123.45" step="0.01">
                </div>
                <div class="form-group">
                    <label>ë‹¨ìœ„</label>
                    <input type="text" id="usageUnit" placeholder="kWh" value="kWh">
                </div>
                <div class="form-group">
                    <label>í˜„ì¬ ìš”ê¸ˆ</label>
                    <input type="number" id="usageCharge" placeholder="15000" value="15000" step="0.01">
                </div>

                <div class="button-group">
                    <button onclick="createUsageData()">ì‚¬ìš©ëŸ‰ ë“±ë¡</button>
                    <button class="secondary" onclick="getUserUsageData()">ì „ì²´ ì¡°íšŒ</button>
                    <button class="secondary" onclick="getUserUsageDataByType()">ìœ í˜•ë³„ ì¡°íšŒ</button>
                    <button class="secondary" onclick="getLatestUsageData()">ìµœì‹  ì¡°íšŒ</button>
                    <button class="clear-btn" onclick="clearResponse('usageResponse')">Clear</button>
                </div>

                <div class="response-box" id="usageResponse">
                    <pre>ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</pre>
                </div>
            </div>

            <!-- ì²­êµ¬ì„œ ì¹´ë“œ -->
            <div class="card">
                <h2 class="card-title">ğŸ’° ì²­êµ¬ì„œ (Monthly Bill)</h2>

                <div class="form-group">
                    <label>ì²­êµ¬ ì›” (YYYY-MM-DD)</label>
                    <input type="date" id="billingMonth" value="2025-01-01">
                </div>
                <div class="form-group">
                    <label>ì´ ìš”ê¸ˆ</label>
                    <input type="number" id="billAmount" placeholder="50000" value="50000" step="0.01">
                </div>
                <div class="form-group">
                    <label>ì²­êµ¬ì„œ ID (ë‚©ë¶€ìš©)</label>
                    <input type="number" id="billId" placeholder="1" value="1">
                </div>

                <div class="button-group">
                    <button onclick="getUserBills()">ì²­êµ¬ì„œ ì¡°íšŒ</button>
                    <button class="secondary" onclick="getUnpaidBills()">ë¯¸ë‚© ì¡°íšŒ</button>
                    <button class="secondary" onclick="markBillAsPaid()">ë‚©ë¶€ ì²˜ë¦¬</button>
                    <button class="clear-btn" onclick="clearResponse('billResponse')">Clear</button>
                </div>

                <div class="response-box" id="billResponse">
                    <pre>ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</pre>
                </div>
            </div>

            <!-- ì•Œë¦¼ ì¹´ë“œ -->
            <div class="card">
                <h2 class="card-title">ğŸ”” ì•Œë¦¼ (Usage Alert)</h2>

                <div class="form-group">
                    <label>ì•Œë¦¼ íƒ€ì…</label>
                    <select id="alertType">
                        <option value="HIGH_USAGE">ë†’ì€ ì‚¬ìš©ëŸ‰ (HIGH_USAGE)</option>
                        <option value="BUDGET_EXCEEDED">ì˜ˆì‚° ì´ˆê³¼ (BUDGET_EXCEEDED)</option>
                        <option value="UNUSUAL_PATTERN">ë¹„ì •ìƒ íŒ¨í„´ (UNUSUAL_PATTERN)</option>
                        <option value="POSITIVE_FEEDBACK">ê¸ì •ì  í”¼ë“œë°± (POSITIVE_FEEDBACK)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ì•Œë¦¼ ID (ì½ìŒ ì²˜ë¦¬ìš©)</label>
                    <input type="number" id="alertId" placeholder="1" value="1">
                </div>

                <div class="button-group">
                    <button onclick="getUserAlerts()">ì•Œë¦¼ ì¡°íšŒ</button>
                    <button class="secondary" onclick="getUnreadAlerts()">ë¯¸ì½ìŒ ì¡°íšŒ</button>
                    <button class="secondary" onclick="markAlertAsRead()">ì½ìŒ ì²˜ë¦¬</button>
                    <button class="secondary" onclick="markAllAlertsAsRead()">ëª¨ë‘ ì½ìŒ</button>
                    <button class="clear-btn" onclick="clearResponse('alertResponse')">Clear</button>
                </div>

                <div class="response-box" id="alertResponse">
                    <pre>ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</pre>
                </div>
            </div>

            <!-- AI ì¶”ì²œ ì¹´ë“œ -->
            <div class="card">
                <h2 class="card-title">ğŸ¤– AI ì¶”ì²œ (Recommendation)</h2>

                <div class="info-text">
                    ì‚¬ìš© íŒ¨í„´ì„ ë¶„ì„í•˜ì—¬ ë§ì¶¤í˜• ì ˆì•½ ì¶”ì²œì„ ìƒì„±í•©ë‹ˆë‹¤
                </div>

                <div class="form-group">
                    <label>ì¶”ì²œ ID (ì ìš©ìš©)</label>
                    <input type="number" id="recId" placeholder="1" value="1">
                </div>

                <div class="button-group">
                    <button onclick="generateRecommendations()">AI ì¶”ì²œ ìƒì„±</button>
                    <button class="secondary" onclick="getUserRecommendations()">ì¶”ì²œ ì¡°íšŒ</button>
                    <button class="secondary" onclick="getUnappliedRecommendations()">ë¯¸ì ìš© ì¡°íšŒ</button>
                    <button class="secondary" onclick="markAsApplied()">ì¶”ì²œ ì ìš©</button>
                    <button class="clear-btn" onclick="clearResponse('recResponse')">Clear</button>
                </div>

                <div class="response-box" id="recResponse">
                    <pre>ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</pre>
                </div>
            </div>

            <!-- ì ˆê° ì¶”ì  ì¹´ë“œ -->
            <div class="card">
                <h2 class="card-title">ğŸ’¸ ì ˆê° ì¶”ì  (Savings Tracking)</h2>

                <div class="form-group">
                    <label>ì¶”ì  ID</label>
                    <input type="number" id="trackingId" placeholder="1" value="1">
                </div>

                <div class="button-group">
                    <button onclick="startTracking()">ì¶”ì  ì‹œì‘</button>
                    <button class="secondary" onclick="getUserTrackings()">ì¶”ì  ì¡°íšŒ</button>
                    <button class="secondary" onclick="getTotalSavings()">ì´ ì ˆê°ì•¡</button>
                    <button class="clear-btn" onclick="clearResponse('savingsResponse')">Clear</button>
                </div>

                <div class="response-box" id="savingsResponse">
                    <pre>ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</pre>
                </div>
            </div>

            <!-- ì‚¬ìš© íŒ¨í„´ ì¹´ë“œ -->
            <div class="card">
                <h2 class="card-title">ğŸ“ˆ ì‚¬ìš© íŒ¨í„´ (Usage Pattern)</h2>

                <div class="info-text">
                    ì‚¬ìš© ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ íŒ¨í„´ì„ ì°¾ì•„ëƒ…ë‹ˆë‹¤
                </div>

                <div class="button-group">
                    <button onclick="analyzePatterns()">íŒ¨í„´ ë¶„ì„</button>
                    <button class="secondary" onclick="getUserPatterns()">íŒ¨í„´ ì¡°íšŒ</button>
                    <button class="secondary" onclick="getUserPatternsByType()">ìœ í˜•ë³„ ì¡°íšŒ</button>
                    <button class="clear-btn" onclick="clearResponse('patternResponse')">Clear</button>
                </div>

                <div class="response-box" id="patternResponse">
                    <pre>ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</pre>
                </div>
            </div>

            <!-- ì‚¬ìš©ì ì„¤ì • ì¹´ë“œ -->
            <div class="card">
                <h2 class="card-title">âš™ï¸ ì‚¬ìš©ì ì„¤ì • (User Setting)</h2>

                <div class="form-group">
                    <label>ì›”ê°„ ì˜ˆì‚°</label>
                    <input type="number" id="monthlyBudget" placeholder="100000" value="100000">
                </div>
                <div class="form-group">
                    <label>ì•Œë¦¼ ì„ê³„ê°’ (%)</label>
                    <input type="number" id="alertThreshold" placeholder="80" value="80">
                </div>

                <div class="button-group">
                    <button onclick="getUserSetting()">ì„¤ì • ì¡°íšŒ</button>
                    <button class="secondary" onclick="createUserSetting()">ì„¤ì • ìƒì„±</button>
                    <button class="clear-btn" onclick="clearResponse('settingResponse')">Clear</button>
                </div>

                <div class="response-box" id="settingResponse">
                    <pre>ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = '/api/v1';
        let accessToken = localStorage.getItem('accessToken') || '';
        let currentUserId = localStorage.getItem('userId') || '1';

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¸ì¦ ìƒíƒœ í™•ì¸
        updateAuthStatus();

        function updateAuthStatus() {
            const statusBadge = document.getElementById('authStatus');
            const userInfo = document.getElementById('userInfo');

            if (accessToken) {
                statusBadge.textContent = 'ë¡œê·¸ì¸ë¨';
                statusBadge.className = 'status-badge logged-in';
                userInfo.textContent = `User ID: ${currentUserId}`;
                document.getElementById('userId').value = currentUserId;
            } else {
                statusBadge.textContent = 'ë¡œê·¸ì•„ì›ƒ';
                statusBadge.className = 'status-badge logged-out';
                userInfo.textContent = '';
            }
        }

        function logout() {
            accessToken = '';
            currentUserId = '1';
            localStorage.removeItem('accessToken');
            localStorage.removeItem('userId');
            updateAuthStatus();
            displayResponse('authResponse', {message: 'ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤'});
        }

        async function apiCall(url, method = 'GET', body = null, responseBoxId = null) {
            try {
                const options = {
                    method,
                    headers: {
                        'Content-Type': 'application/json',
                    }
                };

                if (accessToken && !url.includes('/auth/signup') && !url.includes('/auth/login')) {
                    options.headers['Authorization'] = `Bearer ${accessToken}`;
                }

                if (body) {
                    options.body = JSON.stringify(body);
                }

                const response = await fetch(url, options);
                const data = await response.json();

                if (responseBoxId) {
                    displayResponse(responseBoxId, {
                        status: response.status,
                        statusText: response.statusText,
                        data: data
                    });
                }

                return data;
            } catch (error) {
                if (responseBoxId) {
                    displayResponse(responseBoxId, {
                        error: error.message
                    });
                }
                throw error;
            }
        }

        function displayResponse(boxId, data) {
            const box = document.getElementById(boxId);
            box.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
        }

        function clearResponse(boxId) {
            document.getElementById(boxId).innerHTML = '<pre>ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</pre>';
        }

        function getUserIdFromInput() {
            return document.getElementById('userId').value || currentUserId;
        }

        // ===== ì¸ì¦ API =====
        async function signUp() {
            const body = {
                email: document.getElementById('authEmail').value,
                password: document.getElementById('authPassword').value,
                name: document.getElementById('authName').value,
                phone: document.getElementById('authPhone').value,
                address: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬',
                dateOfBirth: '1990-01-01'
            };
            await apiCall(`${API_BASE_URL}/auth/signup`, 'POST', body, 'authResponse');
        }

        async function login() {
            const body = {
                email: document.getElementById('authEmail').value,
                password: document.getElementById('authPassword').value
            };
            const data = await apiCall(`${API_BASE_URL}/auth/login`, 'POST', body, 'authResponse');

            if (data.accessToken) {
                accessToken = data.accessToken;
                localStorage.setItem('accessToken', accessToken);

                if (data.userId) {
                    currentUserId = data.userId;
                    localStorage.setItem('userId', currentUserId);
                }
                updateAuthStatus();
            }
        }

        async function getUserById() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/auth/users/${userId}`, 'GET', null, 'authResponse');
        }

        // ===== ì‚¬ìš©ëŸ‰ ë°ì´í„° API =====
        async function createUsageData() {
            const userId = getUserIdFromInput();
            const body = {
                utilityType: document.getElementById('usageType').value,
                usageAmount: parseFloat(document.getElementById('usageAmount').value),
                unit: document.getElementById('usageUnit').value,
                currentCharge: parseFloat(document.getElementById('usageCharge').value),
                measuredAt: new Date().toISOString()
            };
            await apiCall(`${API_BASE_URL}/usage-data/users/${userId}`, 'POST', body, 'usageResponse');
        }

        async function getUserUsageData() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/usage-data/users/${userId}`, 'GET', null, 'usageResponse');
        }

        async function getUserUsageDataByType() {
            const userId = getUserIdFromInput();
            const utilityType = document.getElementById('usageType').value;
            await apiCall(`${API_BASE_URL}/usage-data/users/${userId}/type/${utilityType}`, 'GET', null, 'usageResponse');
        }

        async function getLatestUsageData() {
            const userId = getUserIdFromInput();
            const utilityType = document.getElementById('usageType').value;
            await apiCall(`${API_BASE_URL}/usage-data/users/${userId}/latest/${utilityType}`, 'GET', null, 'usageResponse');
        }

        // ===== ì²­êµ¬ì„œ API =====
        async function getUserBills() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/bills/users/${userId}`, 'GET', null, 'billResponse');
        }

        async function getUnpaidBills() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/bills/users/${userId}/unpaid`, 'GET', null, 'billResponse');
        }

        async function markBillAsPaid() {
            const billId = document.getElementById('billId').value;
            await apiCall(`${API_BASE_URL}/bills/${billId}/pay`, 'PATCH', null, 'billResponse');
        }

        // ===== ì•Œë¦¼ API =====
        async function getUserAlerts() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/alerts/users/${userId}`, 'GET', null, 'alertResponse');
        }

        async function getUnreadAlerts() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/alerts/users/${userId}/unread`, 'GET', null, 'alertResponse');
        }

        async function markAlertAsRead() {
            const alertId = document.getElementById('alertId').value;
            await apiCall(`${API_BASE_URL}/alerts/${alertId}/read`, 'PATCH', null, 'alertResponse');
        }

        async function markAllAlertsAsRead() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/alerts/users/${userId}/read-all`, 'PATCH', null, 'alertResponse');
        }

        // ===== AI ì¶”ì²œ API =====
        async function generateRecommendations() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/recommendations/users/${userId}/generate`, 'POST', null, 'recResponse');
        }

        async function getUserRecommendations() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/recommendations/users/${userId}`, 'GET', null, 'recResponse');
        }

        async function getUnappliedRecommendations() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/recommendations/users/${userId}/unapplied`, 'GET', null, 'recResponse');
        }

        async function markAsApplied() {
            const recId = document.getElementById('recId').value;
            await apiCall(`${API_BASE_URL}/recommendations/${recId}/apply`, 'PATCH', null, 'recResponse');
        }

        // ===== ì ˆê° ì¶”ì  API =====
        async function startTracking() {
            const userId = getUserIdFromInput();
            const recId = document.getElementById('recId').value;
            await apiCall(`${API_BASE_URL}/savings/users/${userId}/recommendations/${recId}/start`, 'POST', null, 'savingsResponse');
        }

        async function getUserTrackings() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/savings/users/${userId}`, 'GET', null, 'savingsResponse');
        }

        async function getTotalSavings() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/savings/users/${userId}/total`, 'GET', null, 'savingsResponse');
        }

        // ===== ì‚¬ìš© íŒ¨í„´ API =====
        async function analyzePatterns() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/patterns/users/${userId}/analyze`, 'POST', null, 'patternResponse');
        }

        async function getUserPatterns() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/patterns/users/${userId}`, 'GET', null, 'patternResponse');
        }

        async function getUserPatternsByType() {
            const userId = getUserIdFromInput();
            const utilityType = document.getElementById('usageType').value;
            await apiCall(`${API_BASE_URL}/patterns/users/${userId}/type/${utilityType}`, 'GET', null, 'patternResponse');
        }

        // ===== ì‚¬ìš©ì ì„¤ì • API =====
        async function getUserSetting() {
            const userId = getUserIdFromInput();
            await apiCall(`${API_BASE_URL}/settings/users/${userId}`, 'GET', null, 'settingResponse');
        }

        async function createUserSetting() {
            const userId = getUserIdFromInput();
            const body = {
                monthlyBudget: parseFloat(document.getElementById('monthlyBudget').value),
                alertThreshold: parseFloat(document.getElementById('alertThreshold').value),
                pushEnabled: true,
                emailEnabled: true
            };
            await apiCall(`${API_BASE_URL}/settings/users/${userId}`, 'POST', body, 'settingResponse');
        }
    </script>
</body>
</html>